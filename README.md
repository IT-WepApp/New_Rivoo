# العمارة البرمجية لمشروع Rivoo

## نظرة عامة على المشروع

مشروع Rivoo هو نظام متكامل للتجارة الإلكترونية يتكون من أربعة تطبيقات رئيسية مع مكتبات مشتركة:

1. **تطبيق المستخدم (user_app)**: واجهة المستخدم النهائي للتسوق وإدارة الطلبات
2. **لوحة تحكم البائع (seller_panel)**: منصة لأصحاب المتاجر لإدارة منتجاتهم وطلباتهم
3. **لوحة تحكم المسؤول (admin_panell)**: منصة للمسؤولين لإدارة النظام بالكامل
4. **تطبيق التوصيل (delivery_app)**: تطبيق مخصص لمندوبي التوصيل لإدارة عمليات التسليم

## هيكل المشروع

```
Rivoo/
├── admin_panell/           # لوحة تحكم المسؤول
├── delivery_app/           # تطبيق التوصيل
├── seller_panel/           # لوحة تحكم البائع
├── user_app/               # تطبيق المستخدم النهائي
├── shared_libs/            # المكتبات المشتركة
├── ci_cd/                  # ملفات التكامل المستمر والنشر المستمر
├── docs/                   # التوثيق
├── tests/                  # اختبارات المشروع
├── .github/                # ملفات GitHub Actions
├── pubspec.yaml            # ملف تبعيات المشروع الرئيسي
├── dependencies.yaml       # ملف تعريف إصدارات التبعيات الموحدة
└── melos.yaml              # ملف تكوين أداة Melos لإدارة المشاريع المتعددة
```

## العمارة البرمجية

### 1. النمط المعماري العام

يتبع المشروع نمط **Clean Architecture** مع **Feature-first Architecture** حيث:

- يتم تنظيم الكود حسب الميزات الوظيفية (features)
- كل ميزة تحتوي على طبقات منفصلة (العرض، منطق الأعمال، البيانات)
- استخدام نمط MVVM (Model-View-ViewModel) مع Riverpod لإدارة الحالة

### 2. هيكل التطبيقات الفرعية

كل تطبيق فرعي يتبع هيكلًا مشابهًا:

```
app/
├── lib/
│   ├── core/              # المكونات الأساسية
│   │   ├── auth/          # المصادقة والتفويض
│   │   ├── network/       # خدمات الشبكة
│   │   ├── storage/       # خدمات التخزين
│   │   └── utils/         # أدوات مساعدة
│   ├── features/          # الميزات الوظيفية
│   │   ├── feature1/
│   │   │   ├── data/      # طبقة البيانات
│   │   │   ├── domain/    # طبقة منطق الأعمال
│   │   │   └── presentation/ # طبقة العرض
│   │   └── feature2/
│   ├── constants/         # الثوابت
│   ├── l10n/              # التعريب والتدويل
│   ├── theme/             # سمات التطبيق
│   ├── main.dart          # نقطة الدخول الرئيسية
│   └── router.dart        # تكوين التوجيه
└── ...
```

### 3. المكتبات المشتركة

تحتوي المكتبة المشتركة على:

```
shared_libs/
├── lib/
│   ├── models/            # نماذج البيانات المشتركة
│   ├── services/          # الخدمات المشتركة
│   ├── widgets/           # مكونات واجهة المستخدم المشتركة
│   └── shared_libs.dart   # ملف التصدير الرئيسي
└── ...
```

## تدفق البيانات

### 1. نمط تدفق البيانات العام

يتبع المشروع نمط تدفق بيانات أحادي الاتجاه (Unidirectional Data Flow):

1. **واجهة المستخدم (UI)**: تعرض البيانات وترسل الأحداث
2. **مزودات الحالة (State Providers)**: تدير حالة التطبيق باستخدام Riverpod
3. **حالات الاستخدام (Use Cases)**: تنفذ منطق الأعمال
4. **المستودعات (Repositories)**: تتعامل مع مصادر البيانات
5. **مصادر البيانات (Data Sources)**: تتفاعل مع API الخارجية أو التخزين المحلي

### 2. تدفق المصادقة

```
1. المستخدم يدخل بيانات الاعتماد
2. AuthViewModel يرسل طلب المصادقة
3. AuthRepository يتحقق من البيانات عبر Firebase Auth
4. تخزين رمز المصادقة في SecureStorage
5. تحديث حالة المصادقة في AuthProvider
6. توجيه المستخدم إلى الشاشة المناسبة
```

### 3. تدفق الطلبات

```
1. المستخدم يقدم طلبًا في تطبيق المستخدم
2. OrderRepository يخزن الطلب في Firestore
3. إشعار يُرسل إلى البائع عبر Firebase Messaging
4. البائع يعالج الطلب في لوحة تحكم البائع
5. عند الموافقة، يُرسل إشعار إلى تطبيق التوصيل
6. مندوب التوصيل يستلم الطلب ويتتبع التسليم
7. تحديث حالة الطلب في الوقت الفعلي لجميع الأطراف
```

## آليات الأمان والمصادقة

### 1. المصادقة

- استخدام Firebase Authentication للمصادقة
- دعم تسجيل الدخول بالبريد الإلكتروني وكلمة المرور
- دعم تسجيل الدخول عبر مزودي الهوية الاجتماعية
- تخزين رموز المصادقة بشكل آمن باستخدام Flutter Secure Storage

### 2. التفويض

- نظام أدوار متعدد المستويات (مستخدم، بائع، مندوب توصيل، مسؤول)
- حراس المصادقة (AuthGuard) للتحقق من صلاحيات الوصول إلى الشاشات
- قواعد أمان Firestore للتحكم في الوصول إلى البيانات

### 3. أمان البيانات

- تشفير البيانات الحساسة في التخزين المحلي
- اتصالات HTTPS آمنة مع الخدمات الخلفية
- التحقق من صحة البيانات على جانب العميل والخادم

## واجهات المستخدم الرئيسية

### 1. تطبيق المستخدم (user_app)

- شاشة البداية والمصادقة
- الصفحة الرئيسية وعرض المنتجات
- تفاصيل المنتج
- سلة التسوق
- الدفع وتتبع الطلبات
- الملف الشخصي والإعدادات

### 2. لوحة تحكم البائع (seller_panel)

- لوحة القيادة الرئيسية
- إدارة المنتجات
- إدارة الطلبات
- إدارة العروض الترويجية
- الإحصائيات والتقارير
- الملف الشخصي والإعدادات

### 3. لوحة تحكم المسؤول (admin_panell)

- لوحة القيادة الرئيسية
- إدارة الفئات
- إدارة المنتجات
- إدارة الطلبات
- إدارة المستخدمين
- إدارة المتاجر
- الإحصائيات والتقارير

### 4. تطبيق التوصيل (delivery_app)

- شاشة تسجيل الدخول
- قائمة الطلبات المتاحة
- خريطة التوصيل
- تفاصيل الطلب
- سجل التوصيل
- الملف الشخصي والإعدادات

## التكامل مع الخدمات الخارجية

1. **Firebase**
   - Firebase Authentication للمصادقة
   - Cloud Firestore لتخزين البيانات
   - Firebase Storage لتخزين الملفات
   - Firebase Messaging للإشعارات
   - Firebase Analytics للتحليلات
   - Firebase Crashlytics لتتبع الأخطاء

2. **خدمات الموقع والخرائط**
   - Google Maps لعرض الخرائط وتتبع التوصيل
   - Geolocator لتحديد الموقع الحالي

3. **خدمات الدفع**
   - واجهة برمجة تطبيقات للتكامل مع بوابات الدفع المختلفة

## استراتيجية النشر

1. **تطبيقات الويب**
   - نشر لوحة تحكم المسؤول ولوحة تحكم البائع على Firebase Hosting

2. **تطبيقات الجوال**
   - بناء تطبيقات Android (APK) لجميع التطبيقات
   - بناء تطبيقات iOS لتطبيق المستخدم وتطبيق التوصيل

3. **التكامل المستمر والنشر المستمر**
   - استخدام GitHub Actions للتكامل المستمر والنشر المستمر
   - اختبارات تلقائية قبل النشر
   - نشر تلقائي عند الدمج في الفروع الرئيسية
# تقرير شامل عن مشروع Rivoo

## الملخص التنفيذي

مشروع Rivoo هو نظام متكامل للتجارة الإلكترونية مبني باستخدام إطار عمل Flutter. يتكون المشروع من أربعة تطبيقات رئيسية مترابطة مع مكتبات مشتركة، مما يوفر حلاً شاملاً لجميع أصحاب المصلحة في منظومة التجارة الإلكترونية: المستخدمين النهائيين، البائعين، مندوبي التوصيل، والمسؤولين.

يتميز المشروع بهيكلة معمارية نظيفة تتبع نمط Feature-first مع Clean Architecture، واستخدام تقنيات حديثة مثل Riverpod لإدارة الحالة وGoRouter للتنقل. كما يعتمد المشروع على خدمات Firebase للمصادقة وتخزين البيانات والإشعارات، مما يوفر بنية تحتية قوية وقابلة للتوسع.

## هيكل المشروع

### التطبيقات الرئيسية

1. **تطبيق المستخدم (user_app)**
   - واجهة المستخدم النهائي للتسوق
   - تصفح المنتجات وإدارة الطلبات
   - متابعة حالة التوصيل
   - إدارة الملف الشخصي والإعدادات

2. **لوحة تحكم البائع (seller_panel)**
   - منصة لأصحاب المتاجر
   - إدارة المنتجات والمخزون
   - معالجة الطلبات
   - إدارة العروض الترويجية
   - عرض الإحصائيات والتقارير

3. **لوحة تحكم المسؤول (admin_panell)**
   - منصة للمسؤولين
   - إدارة الفئات والمنتجات
   - إدارة المستخدمين والمتاجر
   - مراقبة النظام بالكامل
   - عرض الإحصائيات والتقارير الشاملة

4. **تطبيق التوصيل (delivery_app)**
   - تطبيق مخصص لمندوبي التوصيل
   - استلام وإدارة طلبات التوصيل
   - تتبع المسار على الخريطة
   - تحديث حالة التوصيل
   - إدارة سجل التوصيل

### المكتبات المشتركة

تحتوي المكتبة المشتركة (shared_libs) على:
- نماذج البيانات المشتركة
- الخدمات المشتركة
- مكونات واجهة المستخدم المشتركة
- نظام الثيم الموحد
- دعم تعدد اللغات

## التقنيات المستخدمة

### إطار العمل والبرمجة

- **Flutter**: الإصدار الأدنى المطلوب >=3.0.0، مع استخدام إصدارات متنوعة في التطبيقات الفرعية (3.10.0، 3.16.0، 3.16.x)
- **Dart SDK**: >=2.17.0 <4.0.0
- **أنماط البرمجة**: Clean Architecture، Feature-first Architecture، MVVM، Repository Pattern

### المكتبات الرئيسية

- **إدارة الحالة**: Flutter Riverpod، Provider
- **التوجيه**: GoRouter
- **قواعد البيانات والتخزين**: Firebase (Firestore، Storage)، Shared Preferences، Flutter Secure Storage
- **المصادقة**: Firebase Authentication
- **الشبكة**: Dio، HTTP
- **الموقع والخرائط**: Google Maps Flutter، Geolocator
- **الإشعارات**: Firebase Messaging، Flutter Local Notifications
- **التدويل**: Flutter Localizations، Intl

### أدوات CI/CD

- **GitHub Actions**: للتكامل المستمر والنشر المستمر
- **Firebase Hosting**: لنشر تطبيقات الويب
- **Melos**: لإدارة المشاريع المتعددة

## العمارة البرمجية

### النمط المعماري

يتبع المشروع نمط **Clean Architecture** مع **Feature-first Architecture**:

1. **طبقة العرض (Presentation Layer)**
   - الشاشات والواجهات
   - نماذج العرض (ViewModels)
   - مزودات الحالة (State Providers)

2. **طبقة منطق الأعمال (Domain Layer)**
   - حالات الاستخدام (Use Cases)
   - الكيانات (Entities)
   - واجهات المستودعات (Repository Interfaces)

3. **طبقة البيانات (Data Layer)**
   - تنفيذات المستودعات (Repository Implementations)
   - مصادر البيانات (Data Sources)
   - نماذج البيانات (Data Models)

### تدفق البيانات

يتبع المشروع نمط تدفق بيانات أحادي الاتجاه:

1. واجهة المستخدم ترسل الأحداث
2. مزودات الحالة تعالج الأحداث
3. حالات الاستخدام تنفذ منطق الأعمال
4. المستودعات تتعامل مع مصادر البيانات
5. مصادر البيانات تتفاعل مع API الخارجية أو التخزين المحلي
6. البيانات تتدفق في الاتجاه المعاكس لعرضها في واجهة المستخدم

## آليات الأمان والمصادقة

### المصادقة

- استخدام Firebase Authentication للمصادقة
- دعم تسجيل الدخول بالبريد الإلكتروني وكلمة المرور
- دعم تسجيل الدخول عبر مزودي الهوية الاجتماعية
- تخزين رموز المصادقة بشكل آمن باستخدام Flutter Secure Storage

### التفويض

- نظام أدوار متعدد المستويات (مستخدم، بائع، مندوب توصيل، مسؤول)
- حراس المصادقة (AuthGuard) للتحقق من صلاحيات الوصول إلى الشاشات
- قواعد أمان Firestore للتحكم في الوصول إلى البيانات

### أمان البيانات

- تشفير البيانات الحساسة في التخزين المحلي
- اتصالات HTTPS آمنة مع الخدمات الخلفية
- التحقق من صحة البيانات على جانب العميل والخادم

## التعريب والتدويل

- دعم اللغة العربية كلغة أساسية
- دعم لغات متعددة (العربية، الإنجليزية، الفرنسية، التركية، الأردية)
- استخدام Flutter Localizations و AppLocalizations

## استراتيجية النشر

### تطبيقات الويب

- نشر لوحة تحكم المسؤول ولوحة تحكم البائع على Firebase Hosting
- استخدام GitHub Actions للنشر التلقائي

### تطبيقات الجوال

- بناء تطبيقات Android (APK) لجميع التطبيقات
- بناء تطبيقات iOS لتطبيق المستخدم وتطبيق التوصيل

## نقاط القوة

1. **هيكلة معمارية نظيفة**: تسهل الصيانة والتطوير المستقبلي
2. **تقسيم المشروع**: فصل واضح بين التطبيقات المختلفة حسب المستخدمين
3. **مكتبات مشتركة**: إعادة استخدام الكود بين التطبيقات المختلفة
4. **تقنيات حديثة**: استخدام أحدث التقنيات والمكتبات
5. **دعم متعدد المنصات**: تطبيقات تعمل على Android وiOS والويب
6. **دعم متعدد اللغات**: تدويل كامل مع التركيز على اللغة العربية
7. **تكامل CI/CD**: عمليات بناء ونشر آلية

## نقاط التحسين المحتملة

1. **توحيد إصدارات Flutter**: استخدام نفس الإصدار في جميع التطبيقات
2. **توثيق أفضل**: زيادة التوثيق داخل الكود
3. **تغطية اختبارات أكبر**: زيادة الاختبارات الوحدية واختبارات التكامل
4. **تحسين أداء التطبيق**: تحسين أوقات التحميل واستجابة التطبيق
5. **تعزيز الأمان**: مراجعة وتعزيز آليات الأمان

## الخلاصة

مشروع Rivoo هو نظام متكامل للتجارة الإلكترونية مبني بشكل احترافي باستخدام Flutter. يتميز المشروع بهيكلة معمارية نظيفة وتقنيات حديثة، مما يجعله قابلاً للتوسع والصيانة. التقسيم الواضح بين التطبيقات المختلفة والمكتبات المشتركة يسهل عملية التطوير والصيانة، بينما يوفر تجربة مستخدم متسقة عبر جميع المنصات.

مع بعض التحسينات المقترحة، يمكن أن يصبح المشروع أكثر قوة وكفاءة، مما يعزز قدرته على المنافسة في سوق التجارة الإلكترونية.




# التقنيات والأطر المستخدمة في مشروع Rivoo

## إصدارات Flutter
- يستخدم المشروع Flutter بإصدارات متعددة حسب التطبيق الفرعي:
  - الإصدار الأدنى المطلوب: Flutter >= 3.0.0
  - إصدار لوحة تحكم المسؤول (admin_panell): Flutter 3.10.0
  - إصدار لوحة تحكم البائع (seller_panel): Flutter 3.16.x
  - إصدار تطبيق التوصيل (delivery_app): Flutter 3.16.0

## إصدار Dart SDK
- يستخدم المشروع Dart SDK بإصدار: >= 2.17.0 < 4.0.0

## المكتبات والحزم الرئيسية

### خدمات Firebase
- firebase_core: ^2.15.0 / ^3.13.0
- firebase_auth: ^4.7.2 / ^5.5.2
- firebase_messaging: ^14.6.5 / ^15.2.5
- firebase_analytics: ^10.4.4 / ^10.8.0
- cloud_firestore: ^4.8.4 / ^5.6.6
- firebase_storage: ^11.2.5 / ^11.6.0
- firebase_crashlytics: ^3.4.8
- cloud_functions: ^3.5.8
- firebase_performance: ^0.9.3+8

### إدارة الحالة
- flutter_riverpod: ^2.3.6 / ^2.4.10
- riverpod: ^2.5.0
- provider: ^6.0.5
- equatable: ^2.0.5
- dartz: ^0.10.1

### التوجيه والتنقل
- go_router: ^10.0.0 / ^13.2.0

### خدمات التخزين المحلي
- flutter_secure_storage: ^9.0.0
- shared_preferences: ^2.2.0
- path_provider: ^2.1.1

### خدمات الشبكة
- dio: ^5.3.0
- http: ^1.1.0
- connectivity_plus: ^5.0.2

### خدمات الموقع والخرائط
- geolocator: ^12.0.0
- geocoding: ^2.1.0
- google_maps_flutter: ^2.5.3 / ^2.10.1

### واجهة المستخدم
- cached_network_image: ^3.2.3 / ^3.3.1
- flutter_svg: ^2.0.7
- intl: ^0.19.0
- google_fonts: ^5.1.0
- flutter_spinkit: ^5.2.0
- shimmer: ^3.0.0
- fl_chart: ^0.65.0

### خدمات الإشعارات
- flutter_local_notifications: ^15.1.0

### أدوات المطور
- logger: ^1.4.0
- uuid: ^3.0.7
- json_annotation: ^4.8.1
- flutter_dotenv: ^5.1.0

### أدوات التطوير
- build_runner: ^2.4.6
- json_serializable: ^6.7.1
- mockito: ^5.4.2
- flutter_lints: ^2.0.2 / ^2.0.0
- flutter_launcher_icons: ^0.13.1
- melos: ^6.3.2

## أنماط البرمجة المستخدمة
- **هيكلة المشروع**: تقسيم المشروع إلى تطبيقات فرعية متعددة (user_app, seller_panel, admin_panell, delivery_app)
- **هيكلة الميزات**: استخدام نمط Feature-first architecture حيث يتم تنظيم الكود حسب الميزات الوظيفية
- **نمط Repository**: استخدام نمط المستودع لفصل منطق الوصول إلى البيانات
- **نمط MVVM**: استخدام نمط Model-View-ViewModel مع Riverpod لإدارة الحالة
- **نمط Clean Architecture**: فصل طبقات التطبيق (العرض، منطق الأعمال، البيانات)
- **Dependency Injection**: حقن التبعيات باستخدام Riverpod

## أدوات CI/CD المستخدمة
- **GitHub Actions**: للتكامل المستمر والنشر المستمر
- **خطوات CI/CD**:
  - تحليل الكود (flutter analyze)
  - اختبارات الوحدة (flutter test)
  - بناء التطبيق (flutter build)
  - نشر التطبيق (Firebase Hosting)
- **استراتيجية الفروع**:
  - الفروع الرئيسية: main, master, develop
  - فروع الميزات: مثل Seller_panel/**

## التعريب والتدويل
- دعم اللغة العربية كلغة أساسية
- دعم لغات متعددة (العربية، الإنجليزية، الفرنسية، التركية، الأردية)
- استخدام Flutter Localizations و AppLocalizations

## الأمان والمصادقة
- استخدام Firebase Authentication للمصادقة
- استخدام Flutter Secure Storage للتخزين الآمن
- تنفيذ حراس المصادقة (AuthGuard) للتحقق من صلاحيات المستخدم

## النشر والتوزيع
- نشر تطبيقات الويب على Firebase Hosting
- بناء تطبيقات Android (APK)
- بناء تطبيقات iOS
